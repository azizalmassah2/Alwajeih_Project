<UserControl
  x:Class="Alwajeih.Views.Members.MemberStatementView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:vm="clr-namespace:Alwajeih.ViewModels.Members"
  xmlns:converters="clr-namespace:Alwajeih.Utilities.Converters"
  FlowDirection="RightToLeft"
  FontFamily="{StaticResource Tajawal}"
  FontSize="14"
>
  <UserControl.DataContext>
    <vm:MemberStatementViewModel />
  </UserControl.DataContext>
  <UserControl.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Resources/Styles/ScrollBarStyles.xaml" />
        <ResourceDictionary Source="/Resources/Styles/Colors.xaml" />
        <ResourceDictionary Source="/Resources/Styles/Buttons.xaml" />
        <ResourceDictionary Source="/Resources/Styles/TextBoxes.xaml" />
        <ResourceDictionary Source="/Resources/Styles/MainStyles.xaml" />
        <ResourceDictionary Source="/Resources/Styles/DataGrids.xaml" />
      </ResourceDictionary.MergedDictionaries>
      <converters:DayNumberToNameConverter x:Key="DayNumberToNameConverter" />
    </ResourceDictionary>
  </UserControl.Resources>
  <Grid Background="{StaticResource BackgroundColor}">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="20">
      <TextBlock Text="ðŸ“„" FontSize="36" Margin="0,0,15,0" />
      <TextBlock Text="ÙƒØ´Ù Ø­Ø³Ø§Ø¨ Ø¹Ø¶Ùˆ" Style="{StaticResource PageTitle}" />
    </StackPanel>
    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
      <StackPanel Margin="20">
        <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ -->
        <Border Style="{StaticResource ModernCard}" Margin="0,0,0,20">
          <StackPanel>
            <TextBlock
              Text="ðŸ‘¤ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ø¶Ùˆ"
              FontSize="16"
              FontWeight="SemiBold"
              Margin="0,0,0,15"
            />
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="150" />
                <ColumnDefinition Width="*" MinWidth="150" />
              </Grid.ColumnDefinitions>
              <StackPanel Grid.Column="0" Margin="0,0,10,0">
                <TextBlock Text="Ø§Ù„Ø§Ø³Ù…" Foreground="#64748B" Margin="0,0,0,5" />
                <TextBlock Text="{Binding SelectedMember.Name}" FontSize="16" FontWeight="Medium" />
              </StackPanel>
              <StackPanel Grid.Column="1">
                <TextBlock Text="Ø§Ù„Ù‡Ø§ØªÙ" Foreground="#64748B" Margin="0,0,0,5" />
                <TextBlock
                  Text="{Binding SelectedMember.Phone}"
                  FontSize="16"
                  FontWeight="Medium"
                />
              </StackPanel>
            </Grid>
          </StackPanel>
        </Border>
        <!-- Ù…Ù„Ø®Øµ Ù…Ø§Ù„ÙŠ -->
        <Border Style="{StaticResource ModernCard}" Margin="0,0,0,20">
          <StackPanel>
            <TextBlock
              Text="ðŸ“Š Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø§Ù„ÙŠ"
              FontSize="16"
              FontWeight="SemiBold"
              Margin="0,0,0,15"
            />
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="150" />
                <ColumnDefinition Width="*" MinWidth="150" />
                <ColumnDefinition Width="*" MinWidth="150" />
              </Grid.ColumnDefinitions>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
              </Grid.RowDefinitions>
              <!-- Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ -->
              <Border
                Grid.Row="0"
                Grid.Column="0"
                Background="#EFF6FF"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,10,10"
              >
                <StackPanel>
                  <TextBlock
                    Text="Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ"
                    Foreground="#3B82F6"
                    FontSize="12"
                    Margin="0,0,0,5"
                  />
                  <TextBlock
                    Text="{Binding TotalExpected, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="#1E40AF"
                  />
                </StackPanel>
              </Border>
              <!-- Ù…Ø§ ØªÙ… Ø¯ÙØ¹Ù‡ -->
              <Border
                Grid.Row="0"
                Grid.Column="1"
                Background="#F0FDF4"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,10,10"
              >
                <StackPanel>
                  <TextBlock
                    Text="Ù…Ø§ ØªÙ… Ø¯ÙØ¹Ù‡"
                    Foreground="#22C55E"
                    FontSize="12"
                    Margin="0,0,0,5"
                  />
                  <TextBlock
                    Text="{Binding TotalPaid, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="#15803D"
                  />
                </StackPanel>
              </Border>
              <!-- Ø§Ù„Ø³Ø­ÙˆØ¨Ø§Øª -->
              <Border
                Grid.Row="0"
                Grid.Column="2"
                Background="#FEF3C7"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,0,10"
              >
                <StackPanel>
                  <TextBlock
                    Text="Ø§Ù„Ø³Ø­ÙˆØ¨Ø§Øª"
                    Foreground="#F59E0B"
                    FontSize="12"
                    Margin="0,0,0,5"
                  />
                  <TextBlock
                    Text="{Binding TotalWithdrawals, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="#D97706"
                  />
                </StackPanel>
              </Border>
              <!-- Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ -->
              <Border
                Grid.Row="1"
                Grid.Column="0"
                Background="#FEE2E2"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,10,0"
              >
                <StackPanel>
                  <TextBlock
                    Text="Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¹Ù„ÙŠÙ‡"
                    Foreground="#EF4444"
                    FontSize="12"
                    Margin="0,0,0,5"
                  />
                  <TextBlock
                    Text="{Binding Remaining, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="#DC2626"
                  />
                </StackPanel>
              </Border>
              <!-- Ø§Ù„Ù…ØªØ£Ø®Ø±Ø§Øª -->
              <Border
                Grid.Row="1"
                Grid.Column="1"
                Background="#FEF2F2"
                CornerRadius="8"
                Padding="15"
                Margin="0,0,10,0"
              >
                <StackPanel>
                  <TextBlock Text="Ø§Ù„Ù…ØªØ£Ø®Ø±Ø§Øª" Foreground="#DC2626" FontSize="12" Margin="0,0,0,5" />
                  <TextBlock
                    Text="{Binding TotalArrears, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="#991B1B"
                  />
                </StackPanel>
              </Border>
              <!-- Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ -->
              <Border
                Grid.Row="1"
                Grid.Column="2"
                Background="#DBEAFE"
                CornerRadius="8"
                Padding="15"
              >
                <StackPanel>
                  <TextBlock
                    Text="Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ Ù„Ù„Ø³Ø­Ø¨"
                    Foreground="#2563EB"
                    FontSize="12"
                    Margin="0,0,0,5"
                  />
                  <TextBlock
                    Text="{Binding AvailableBalance, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="#1D4ED8"
                  />
                </StackPanel>
              </Border>
            </Grid>
          </StackPanel>
        </Border>
        <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø³Ø¯Ø§Ø¯Ø§Øª -->
        <Border Style="{StaticResource ModernCard}">
          <StackPanel>
            <TextBlock
              Text="ðŸ’° Ø³Ø¬Ù„ Ø§Ù„Ø³Ø¯Ø§Ø¯Ø§Øª"
              FontSize="16"
              FontWeight="SemiBold"
              Margin="0,0,0,15"
            />
            <!-- DataGrid Ù…Ø¹ Border -->
            <Border
              CornerRadius="8"
              BorderBrush="#E2E8F0"
              BorderThickness="1"
              Background="White"
              Margin="0,0,0,0"
            >
              <DataGrid
                ItemsSource="{Binding MemberCollections}"
                Height="400"
                AutoGenerateColumns="False"
                IsReadOnly="True"
                Style="{StaticResource ModernDataGrid}"
              >
                <DataGrid.Columns>
                  <DataGridTextColumn 
                    Header="Ø±Ù‚Ù… Ø§Ù„Ø¥ÙŠØµØ§Ù„" 
                    Binding="{Binding ReceiptNumber}" 
                    Width="Auto" MinWidth="120" 
                  />
                  <DataGridTextColumn 
                    Header="Ø±Ù‚Ù… Ø§Ù„Ø­ØµØ©" 
                    Binding="{Binding PlanNumber}" 
                    Width="Auto" MinWidth="90" 
                  />
                  <DataGridTextColumn
                    Header="Ø§Ù„Ù…Ø¨Ù„Øº"
                    Binding="{Binding AmountPaid, StringFormat=N2}"
                    Width="Auto" MinWidth="100"
                  />
                  <DataGridTextColumn
                    Header="Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"
                    Binding="{Binding WeekNumber}"
                    Width="Auto" MinWidth="80"
                  />
                  <DataGridTextColumn
                    Header="Ø§Ù„ÙŠÙˆÙ…"
                    Binding="{Binding DayNumber, Converter={StaticResource DayNumberToNameConverter}}"
                    Width="Auto" MinWidth="90"
                  />
                  <DataGridTextColumn
                    Header="Ø§Ù„ØªØ§Ø±ÙŠØ®"
                    Binding="{Binding CollectionDate, StringFormat=yyyy-MM-dd}"
                    Width="Auto" MinWidth="100"
                  />
                  <DataGridTextColumn
                    Header="Ø§Ù„ÙˆÙ‚Øª"
                    Binding="{Binding CollectedAt, StringFormat=HH:mm}"
                    Width="Auto" MinWidth="80"
                  />
                  <DataGridTextColumn 
                    Header="Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹" 
                    Binding="{Binding PaymentType}" 
                    Width="Auto" MinWidth="90" 
                  />
                </DataGrid.Columns>
              </DataGrid>
            </Border>
          </StackPanel>
        </Border>
      </StackPanel>
    </ScrollViewer>
  </Grid>
</UserControl>
