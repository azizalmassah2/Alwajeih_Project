<UserControl
  x:Class="Alwajeih.Views.Members.MemberManagementView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  FlowDirection="RightToLeft"
  FontFamily="{StaticResource Tajawal}"
  FontSize="14"
  xmlns:vm="clr-namespace:Alwajeih.ViewModels.Members"
  xmlns:converters="clr-namespace:Alwajeih.Utilities.Converters"
>
    <UserControl.DataContext>
        <vm:MemberViewModel />
    </UserControl.DataContext>
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Resources/Styles/ScrollBarStyles.xaml" />
                <ResourceDictionary Source="/Resources/Styles/Colors.xaml" />
                <ResourceDictionary Source="/Resources/Styles/Buttons.xaml" />
                <ResourceDictionary Source="/Resources/Styles/TextBoxes.xaml" />
                <ResourceDictionary Source="/Resources/Styles/DataGrids.xaml" />
                <ResourceDictionary Source="/Resources/Styles/MainStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <converters:EmptyStringToVisibilityConverter x:Key="EmptyStringToVisibilityConverter" />
            <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
            <converters:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter" />
            <converters:MemberTypeConverter x:Key="MemberTypeConverter" />
            <converters:CollectionFrequencyConverter x:Key="CollectionFrequencyConverter" />
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid Background="#F8FAFC">
        <ScrollViewer VerticalScrollBarVisibility="Auto" Style="{StaticResource ModernScrollViewer}">
            <StackPanel Margin="20,20">
                <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø­Ø¯ÙŠØ« -->
                <StackPanel Margin="0,0,0,20">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                        <TextBlock Text="ðŸ‘¥" FontSize="24" Margin="0,0,10,0" VerticalAlignment="Center" />
                        <TextBlock
              Text="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡"
              FontSize="22"
              FontWeight="Bold"
              Foreground="#1E293B"
              VerticalAlignment="Center"
            />
                    </StackPanel>
                    <TextBlock
            Text="Ø¥Ø¶Ø§ÙØ© ÙˆØªØ¹Ø¯ÙŠÙ„ ÙˆØ£Ø±Ø´ÙØ© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡"
            FontSize="13"
            Foreground="#64748B"
            Margin="34,0,0,0"
          />
                </StackPanel>
                <Grid Margin="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*" />
                        <ColumnDefinition Width="*" MinWidth="150" />
                    </Grid.ColumnDefinitions>
                    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡ -->
                    <Border
            Grid.Column="0"
            Background="White"
            CornerRadius="12"
            Padding="20"
            Margin="0,0,15,0"
          >
                        <Border.Effect>
                            <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.08" />
                        </Border.Effect>
                        <StackPanel>
                            <TextBlock
                Text="ðŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø¹Ø¶Ø§Ø¡"
                FontSize="16"
                FontWeight="SemiBold"
                Foreground="#1E293B"
                Margin="0,0,0,12"
              />
                            <!-- Ø§Ù„Ø¨Ø­Ø« -->
                            <Grid Margin="0,0,0,15">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" MinWidth="150" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Border
                  Grid.Column="0"
                  Background="#F8FAFC"
                  BorderBrush="#E2E8F0"
                  BorderThickness="1"
                  CornerRadius="8"
                  Height="40"
                  Margin="0,0,10,0"
                >
                                    <Grid>
                                        <TextBlock
                      Text="ðŸ” Ø§Ø¨Ø­Ø« Ù‡Ù†Ø§..."
                      Foreground="#94A3B8"
                      VerticalAlignment="Center"
                      Margin="12,0"
                      IsHitTestVisible="False"
                      Visibility="{Binding SearchText, Converter={StaticResource EmptyStringToVisibilityConverter}}"
                    />
                                        <TextBox
                      Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                      Background="Transparent"
                      BorderThickness="0"
                      Padding="12,0"
                      VerticalContentAlignment="Center"
                    />
                                    </Grid>
                                </Border>
                                <Button
                  Grid.Column="1"
                  Content="ðŸ”„ ØªØ­Ø¯ÙŠØ«"
                  Command="{Binding RefreshCommand}"
                  Width="Auto" MinWidth="90"
                  Height="40"
                  Margin="0,0,10,0"
                  Background="#2563EB"
                  Foreground="White"
                  BorderThickness="0"
                  Cursor="Hand"
                >
                                    <Button.Resources>
                                        <Style TargetType="Border">
                                            <Setter Property="CornerRadius" Value="8" />
                                        </Style>
                                    </Button.Resources>
                                </Button>
                                <CheckBox
                  Grid.Column="2"
                  Content="Ø§Ù„Ù…Ø¤Ø±Ø´ÙÙŠÙ†"
                  IsChecked="{Binding ShowArchived}"
                  VerticalAlignment="Center"
                />
                            </Grid>
                            <!-- DataGrid Ù…Ø¹ Border -->
                            <Border
                CornerRadius="8"
                BorderBrush="#E2E8F0"
                BorderThickness="1"
                Background="White"
                Margin="0,0,0,0"
              >
                                <DataGrid
                  ItemsSource="{Binding Members}"
                  SelectedItem="{Binding SelectedMember}"
                  Height="450"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  Style="{StaticResource ModernDataGrid}"
                >
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Ø§Ù„Ø±Ù‚Ù…" Binding="{Binding MemberID}" Width="Auto" MinWidth="80" />
                                        <DataGridTextColumn Header="Ø§Ù„Ø§Ø³Ù…" Binding="{Binding Name}" Width="*" MinWidth="150" />
                                        <DataGridTextColumn Header="Ø§Ù„Ù‡Ø§ØªÙ" Binding="{Binding Phone}" Width="Auto" MinWidth="120" />
                                        <DataGridTextColumn 
                      Header="Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶Ùˆ" 
                      Binding="{Binding MemberType, Converter={StaticResource MemberTypeConverter}}" 
                      Width="Auto" MinWidth="120"
                    />
                                        <DataGridTextColumn 
                      Header="Ù†ÙˆØ¹ Ø§Ù„ØªØ­ØµÙŠÙ„" 
                      Binding="{Binding CollectionFrequency, Converter={StaticResource CollectionFrequencyConverter}}" 
                      Width="Auto" MinWidth="120"
                    />
                                        <DataGridTextColumn
                      Header="ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„"
                      Binding="{Binding CreatedDate, StringFormat=yyyy-MM-dd}"
                      Width="Auto" MinWidth="130"
                    />
                                    </DataGrid.Columns>
                                </DataGrid>
                            </Border>
                        </StackPanel>
                    </Border>
                    <!-- Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø¶Ø§ÙØ©/Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ -->
                    <Border Grid.Column="1" Style="{StaticResource ModernCard}">
                        <StackPanel>
                            <TextBlock
                Text="{Binding IsEditMode, Converter={StaticResource BoolToString}}"
                Style="{StaticResource SectionTitle}"
              />
                            <TextBlock Text="Ø§Ù„Ø§Ø³Ù… *" Style="{StaticResource FieldLabel}" Margin="0,15,0,5" />
                            <TextBox Text="{Binding Name}" Style="{StaticResource ModernTextBox}" />
                            
                            <TextBlock Text="Ø§Ù„Ù‡Ø§ØªÙ" Style="{StaticResource FieldLabel}" Margin="0,15,0,5" />
                            <TextBox Text="{Binding Phone}" Style="{StaticResource ModernTextBox}" />
                            
                            <!-- Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶Ùˆ -->
                            <TextBlock Text="Ù†ÙˆØ¹ Ø§Ù„Ø¹Ø¶Ùˆ *" Style="{StaticResource FieldLabel}" Margin="0,15,0,5" />
                            <ComboBox SelectedIndex="{Binding MemberTypeIndex}" 
                                      Style="{StaticResource ModernComboBox}">
                                <ComboBoxItem Content="Ø¹Ø¶Ùˆ Ø£Ø³Ø§Ø³ÙŠ" />
                                <ComboBoxItem Content="Ø®Ù„Ù Ø§Ù„Ø¬Ù…Ø¹ÙŠØ©" />
                            </ComboBox>
                            
                            <!-- Ù†ÙˆØ¹ Ø§Ù„ØªØ­ØµÙŠÙ„ - ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ù„Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠÙŠÙ† -->
                            <TextBlock Text="Ù†ÙˆØ¹ Ø§Ù„ØªØ­ØµÙŠÙ„ *" Style="{StaticResource FieldLabel}" Margin="0,15,0,5" 
                                       Visibility="{Binding IsBehindAssociationMember, Converter={StaticResource InverseBooleanToVisibilityConverter}}" />
                            <ComboBox SelectedIndex="{Binding CollectionFrequencyIndex}" 
                                      Style="{StaticResource ModernComboBox}"
                                      Visibility="{Binding IsBehindAssociationMember, Converter={StaticResource InverseBooleanToVisibilityConverter}}">
                                <ComboBoxItem Content="ØªØ­ØµÙŠÙ„ ÙŠÙˆÙ…ÙŠ" />
                                <ComboBoxItem Content="ØªØ­ØµÙŠÙ„ Ø£Ø³Ø¨ÙˆØ¹ÙŠ" />
                            </ComboBox>
                            
                            <!-- Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙŠÙˆÙ…ÙŠ - ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ© ÙˆÙ„Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠÙŠÙ† -->
                            <TextBlock Text="Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙŠÙˆÙ…ÙŠ *" Style="{StaticResource FieldLabel}" Margin="0,15,0,5"
                                       Visibility="{Binding ShowDailyAmountField, Converter={StaticResource BoolToVisibilityConverter}}" />
                            <TextBox Text="{Binding DailyAmount, StringFormat=N2}" Style="{StaticResource ModernTextBox}"
                                     Visibility="{Binding ShowDailyAmountField, Converter={StaticResource BoolToVisibilityConverter}}" />
                            
                            <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
                            <StackPanel Orientation="Horizontal" Margin="0,25,0,0" HorizontalAlignment="Center">
                                <Button
                  Command="{Binding SaveMemberCommand}"
                  Style="{StaticResource SuccessButton}"
                  Width="Auto" MinWidth="100"
                  Margin="5"
                >
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="âœ…" FontSize="16" Margin="0,0,8,0" />
                                        <TextBlock Text="Ø­ÙØ¸" />
                                    </StackPanel>
                                </Button>
                                <Button
                  Command="{Binding CancelCommand}"
                  Style="{StaticResource SecondaryButton}"
                  Width="Auto" MinWidth="100"
                  Margin="5"
                >
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="âŒ" FontSize="16" Margin="0,0,8,0" />
                                        <TextBlock Text="Ø¥Ù„ØºØ§Ø¡" />
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                            <Separator Style="{StaticResource Divider}" Margin="0,20" />
                            <Button Command="{Binding AddMemberCommand}" Style="{StaticResource PrimaryButton}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="âž•" FontSize="16" Margin="0,0,8,0" />
                                    <TextBlock Text="Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ Ø¬Ø¯ÙŠØ¯" />
                                </StackPanel>
                            </Button>
                            <Button
                Command="{Binding EditMemberCommand}"
                Style="{StaticResource SecondaryButton}"
                Margin="0,10,0,0"
              >
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="âœï¸" FontSize="16" Margin="0,0,8,0" />
                                    <TextBlock Text="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ø¶Ùˆ Ø§Ù„Ù…Ø­Ø¯Ø¯" />
                                </StackPanel>
                            </Button>
                            <Button
                Command="{Binding ArchiveMemberCommand}"
                Style="{StaticResource DangerButton}"
                Margin="0,10,0,0"
              >
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ—ƒï¸" FontSize="16" Margin="0,0,8,0" />
                                    <TextBlock Text="Ø£Ø±Ø´ÙØ© Ø§Ù„Ø¹Ø¶Ùˆ" />
                                </StackPanel>
                            </Button>
                            <Button
                Command="{Binding ViewStatementCommand}"
                Style="{StaticResource PrimaryButton}"
                Margin="0,10,0,0"
              >
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ðŸ“„" FontSize="16" Margin="0,0,8,0" />
                                    <TextBlock Text="Ø¹Ø±Ø¶ ÙƒØ´Ù Ø§Ù„Ø­Ø³Ø§Ø¨" />
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Border>
                </Grid>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
