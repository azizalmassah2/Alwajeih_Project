<UserControl x:Class="Alwajeih.Views.Collections.DailyDetailsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             FlowDirection="RightToLeft"
             FontFamily="{StaticResource Tajawal}"
             FontSize="14"
             xmlns:vm="clr-namespace:Alwajeih.ViewModels.Collections">
    
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Resources/Styles/ScrollBarStyles.xaml" />
                <ResourceDictionary Source="/Resources/Styles/Colors.xaml"/>
                <ResourceDictionary Source="/Resources/Styles/Buttons.xaml"/>
                <ResourceDictionary Source="/Resources/Styles/MainStyles.xaml"/>
                <ResourceDictionary Source="/Resources/Styles/DataGrids.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    
    <Grid Background="#F8FAFC">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <Border Grid.Row="0" Background="White" Padding="20,15" BorderBrush="#E2E8F0" BorderThickness="0,0,0,1">
            <Border.Effect>
                <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*" MinWidth="150"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ -->
                <Button Grid.Column="0"
                        Command="{Binding BackCommand}"
                        Width="40" Height="40"
                        Background="#F8FAFC"
                        BorderBrush="#CBD5E1"
                        BorderThickness="1"
                        Margin="0,0,15,0"
                        Cursor="Hand"
                        Style="{StaticResource SecondaryButton}">
                    <TextBlock Text="â—„" FontSize="16" Foreground="#475569" FontWeight="Bold"/>
                </Button>
                
                <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,5">
                        <TextBlock Text="ðŸ“‹" FontSize="24" Margin="0,0,10,0" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding ItemTitle}" 
                                 FontSize="22" 
                                 FontWeight="Bold"
                                 Foreground="#1E293B"
                                 VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock FontSize="13" 
                             Foreground="#64748B"
                             TextAlignment="Center">
                        <Run Text="Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"/>
                        <Run Text="{Binding WeekNumber}" FontWeight="SemiBold" Foreground="#3B82F6"/>
                        <Run Text=" â€¢ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø³Ø¨Ø¹Ø©"/>
                    </TextBlock>
                </StackPanel>
                
                <!-- Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ -->
                <Border Grid.Column="2"
                        Background="#EEF2FF"
                        CornerRadius="10"
                        Padding="15,10"
                        BorderBrush="#C7D2FE"
                        BorderThickness="1">
                    <StackPanel>
                        <TextBlock Text="ðŸ’° Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ" 
                                 FontSize="12" 
                                 Foreground="#4F46E5"
                                 FontWeight="Medium"
                                 TextAlignment="Center"/>
                        <TextBlock FontSize="18" 
                                 FontWeight="Bold"
                                 Foreground="#3B82F6"
                                 TextAlignment="Center"
                                 Margin="0,4,0,0">
                            <Run Text="{Binding TotalAmount, StringFormat=N2}"/>
                            <Run Text=" Ø±ÙŠØ§Ù„" FontSize="12" Foreground="#64748B"/>
                        </TextBlock>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
        
        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">
                
                <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙŠØ§Ù… -->
                <ItemsControl ItemsSource="{Binding DailyDetails}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="White" 
                                    CornerRadius="12" 
                                    Margin="0,0,0,12"
                                    BorderThickness="1"
                                    BorderBrush="#E2E8F0">
                                <Border.Effect>
                                    <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06"/>
                                </Border.Effect>
                                
                                <Expander IsExpanded="True"
                                          Background="Transparent"
                                          BorderThickness="0">
                                    <Expander.Header>
                                        <Grid Margin="10">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*" MinWidth="150"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <!-- Ø±Ù‚Ù… Ø§Ù„ÙŠÙˆÙ… -->
                                            <Border Grid.Column="0"
                                                    Background="#3B82F6"
                                                    Width="50"
                                                    Height="50"
                                                    CornerRadius="25"
                                                    Margin="0,0,15,0">
                                                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                                    <TextBlock Text="{Binding DayNumber}" 
                                                             FontSize="18" 
                                                             FontWeight="Bold"
                                                             Foreground="White"
                                                             TextAlignment="Center"/>
                                                </StackPanel>
                                            </Border>
                                            
                                            <!-- Ø§Ø³Ù… Ø§Ù„ÙŠÙˆÙ… -->
                                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                <TextBlock Text="{Binding DayName}" 
                                                         FontSize="16" 
                                                         FontWeight="SemiBold"
                                                         Foreground="#1E293B"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                    <TextBlock Text="ðŸ“Š" FontSize="11" Margin="0,0,5,0"/>
                                                    <TextBlock FontSize="12" Foreground="#64748B">
                                                        <Run Text="{Binding CollectionsCount}"/>
                                                        <Run Text="Ù…Ø¹Ø§Ù…Ù„Ø©"/>
                                                    </TextBlock>
                                                </StackPanel>
                                            </StackPanel>
                                            
                                            <!-- Ø§Ù„Ù…Ø¨Ù„Øº -->
                                            <TextBlock Grid.Column="2"
                                                     FontSize="18"
                                                     FontWeight="Bold"
                                                     Foreground="#10B981"
                                                     VerticalAlignment="Center">
                                                <Run Text="{Binding DailyIncome, StringFormat=N2}"/>
                                                <Run Text=" Ø±ÙŠØ§Ù„" FontSize="12" Foreground="#64748B"/>
                                            </TextBlock>
                                        </Grid>
                                    </Expander.Header>
                                    
                                    <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙˆØ³ÙŠØ¹ - Ø§Ù„ØªÙØ§ØµÙŠÙ„ -->
                                    <Border BorderThickness="0,1,0,0" 
                                            BorderBrush="#E2E8F0"
                                            Padding="15"
                                            Background="#F8FAFC">
                                        <StackPanel>
                                            <!-- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
                                            <TextBlock Text="ðŸ’³ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ­ØµÙŠÙ„Ø§Øª"
                                                     FontSize="14"
                                                     FontWeight="SemiBold"
                                                     Foreground="#1E293B"
                                                     Margin="0,0,0,12"/>
                                            
                                            <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØ­ØµÙŠÙ„Ø§Øª -->
                                            <Border CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1" Background="White">
                                                <DataGrid ItemsSource="{Binding Collections}"
                                                          AutoGenerateColumns="False"
                                                          IsReadOnly="True"
                                                          HeadersVisibility="Column"
                                                          GridLinesVisibility="None"
                                                          Background="White"
                                                          RowBackground="White"
                                                          AlternatingRowBackground="#F8FAFC"
                                                          CanUserResizeRows="False"
                                                          SelectionMode="Single"
                                                          MaxHeight="300" 
                                                          Style="{StaticResource ModernDataGrid}">
                                                    <DataGrid.Columns>
                                                        <DataGridTextColumn Header="Ø§Ù„Ø¹Ø¶Ùˆ" 
                                                                            Binding="{Binding MemberName}" 
                                                                            Width="*" MinWidth="150"/>
                                                        <DataGridTextColumn Header="Ø§Ù„Ù…Ø¨Ù„Øº" 
                                                                            Binding="{Binding AmountPaid, StringFormat=N2}" 
                                                                            Width="Auto" MinWidth="100"/>
                                                        <DataGridTextColumn Header="Ø§Ù„Ù†ÙˆØ¹" 
                                                                            Binding="{Binding PaymentTypeDescription}" 
                                                                            Width="*" MinWidth="120"/>
                                                        <DataGridTextColumn Header="Ø§Ù„ÙˆÙ‚Øª" 
                                                                            Binding="{Binding CollectedAt, StringFormat=HH:mm}" 
                                                                            Width="Auto" MinWidth="80"/>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </Border>
                                            
                                            <!-- Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ… -->
                                            <Border Background="White"
                                                    CornerRadius="8"
                                                    Padding="15"
                                                    Margin="0,15,0,0"
                                                    BorderThickness="1"
                                                    BorderBrush="#DBEAFE">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" MinWidth="150"/>
                                                        <ColumnDefinition Width="*" MinWidth="150"/>
                                                        <ColumnDefinition Width="*" MinWidth="150"/>
                                                    </Grid.ColumnDefinitions>
                                                    
                                                    <StackPanel Grid.Column="0">
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                                            <TextBlock Text="âœ…" FontSize="12" Margin="0,0,5,0"/>
                                                            <TextBlock Text="Ø§Ù„ÙˆØ§Ø±Ø¯Ø§Øª" FontSize="12" Foreground="#64748B" FontWeight="Medium"/>
                                                        </StackPanel>
                                                        <TextBlock FontSize="16" 
                                                                 FontWeight="Bold"
                                                                 Foreground="#10B981">
                                                            <Run Text="{Binding DailyIncome, StringFormat=N2}"/>
                                                            <Run Text=" Ø±ÙŠØ§Ù„" FontSize="11" Foreground="#64748B"/>
                                                        </TextBlock>
                                                    </StackPanel>
                                                    
                                                    <StackPanel Grid.Column="1">
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                                            <TextBlock Text="â³" FontSize="12" Margin="0,0,5,0"/>
                                                            <TextBlock Text="Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª" FontSize="12" Foreground="#64748B" FontWeight="Medium"/>
                                                        </StackPanel>
                                                        <TextBlock FontSize="16" 
                                                                 FontWeight="Bold"
                                                                 Foreground="#F59E0B">
                                                            <Run Text="{Binding DailyDues, StringFormat=N2}"/>
                                                            <Run Text=" Ø±ÙŠØ§Ù„" FontSize="11" Foreground="#64748B"/>
                                                        </TextBlock>
                                                    </StackPanel>
                                                    
                                                    <StackPanel Grid.Column="2">
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                                            <TextBlock Text="âš ï¸" FontSize="12" Margin="0,0,5,0"/>
                                                            <TextBlock Text="Ø§Ù„Ù…ØªØ£Ø®Ø±Ø§Øª" FontSize="12" Foreground="#64748B" FontWeight="Medium"/>
                                                        </StackPanel>
                                                        <TextBlock FontSize="16" 
                                                                 FontWeight="Bold"
                                                                 Foreground="#EF4444">
                                                            <Run Text="{Binding DailyArrears, StringFormat=N2}"/>
                                                            <Run Text=" Ø±ÙŠØ§Ù„" FontSize="11" Foreground="#64748B"/>
                                                        </TextBlock>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </StackPanel>
                                    </Border>
                                </Expander>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
                
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>
