<UserControl
  x:Class="Alwajeih.Views.Collections.WeekSummaryView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  FlowDirection="RightToLeft"
  FontFamily="{StaticResource Tajawal}"
  FontSize="14"
  xmlns:vm="clr-namespace:Alwajeih.ViewModels.Collections"
>
  <UserControl.DataContext>
    <vm:WeekSummaryViewModel />
  </UserControl.DataContext>
  <UserControl.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Resources/Styles/ScrollBarStyles.xaml" />
        <ResourceDictionary Source="/Resources/Styles/Colors.xaml" />
        <ResourceDictionary Source="/Resources/Styles/Buttons.xaml" />
        <ResourceDictionary Source="/Resources/Styles/MainStyles.xaml" />
        <ResourceDictionary Source="/Resources/Styles/DataGrids.xaml" />
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
  </UserControl.Resources>
  <Grid Background="#F8FAFC">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    
    <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <Border Grid.Row="0" Background="White" Padding="20,15" BorderBrush="#E2E8F0" BorderThickness="0,0,0,1">
      <Border.Effect>
        <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06" />
      </Border.Effect>
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        
        <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ÙˆØµÙ -->
        <StackPanel Grid.Column="0" VerticalAlignment="Center">
          <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
            <TextBlock Text="ðŸ“Š" FontSize="24" Margin="0,0,10,0" VerticalAlignment="Center" />
            <TextBlock
              Text="Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"
              FontSize="22"
              FontWeight="Bold"
              Foreground="#1E293B"
              VerticalAlignment="Center"
            />
          </StackPanel>
          <TextBlock
            Text="Ø¹Ø±Ø¶ ØªÙØµÙŠÙ„ÙŠ Ù„ØªØ­ØµÙŠÙ„Ø§Øª Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"
            FontSize="13"
            Foreground="#64748B"
            Margin="34,0,0,0"
          />
        </StackPanel>
        
        <!-- Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹ -->
        <Border
          Grid.Column="2"
          Background="#F8FAFC"
          CornerRadius="10"
          Padding="8"
          BorderBrush="#E2E8F0"
          BorderThickness="1"
        >
          <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
            <Button
              Command="{Binding PreviousWeekCommand}"
              Width="36"
              Height="36"
              Background="White"
              BorderBrush="#CBD5E1"
              BorderThickness="1"
              Margin="0,0,8,0"
              Cursor="Hand"
              Style="{StaticResource SecondaryButton}"
            >
              <TextBlock
                Text="â—„"
                FontSize="14"
                Foreground="#475569"
                FontWeight="Bold"
              />
            </Button>
            
            <Border
              Background="White"
              CornerRadius="8"
              Padding="15,8"
              BorderBrush="#CBD5E1"
              BorderThickness="1"
              Margin="0,0,8,0"
            >
              <StackPanel Orientation="Horizontal">
                <TextBlock
                  Text="Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹"
                  FontSize="14"
                  FontWeight="Medium"
                  Foreground="#64748B"
                  Margin="0,0,8,0"
                  VerticalAlignment="Center"
                />
                <TextBlock
                  Text="{Binding CurrentWeek}"
                  FontSize="18"
                  FontWeight="Bold"
                  Foreground="#3B82F6"
                  VerticalAlignment="Center"
                />
              </StackPanel>
            </Border>
            
            <Button
              Command="{Binding NextWeekCommand}"
              Width="36"
              Height="36"
              Background="White"
              BorderBrush="#CBD5E1"
              BorderThickness="1"
              Cursor="Hand"
              Style="{StaticResource SecondaryButton}"
            >
              <TextBlock
                Text="â–º"
                FontSize="14"
                Foreground="#475569"
                FontWeight="Bold"
              />
            </Button>
          </StackPanel>
        </Border>
      </Grid>
    </Border>
    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Style="{StaticResource ModernScrollViewer}">
      <StackPanel Margin="20">
        
        <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
        <Grid Margin="0,0,0,20">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>
          
          <!-- Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª (Ù…Ø§Ø¹Ù„ÙŠÙƒÙ…) -->
          <Border Grid.Row="0" Grid.Column="0" Background="White" CornerRadius="12" Padding="20" Margin="0,0,10,10" BorderBrush="#E2E8F0" BorderThickness="1">
            <Border.Effect>
              <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06" />
            </Border.Effect>
            <StackPanel>
              <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Border Background="#EEF2FF" Width="40" Height="40" CornerRadius="20" Margin="0,0,10,0">
                  <TextBlock Text="ðŸ“‹" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <StackPanel VerticalAlignment="Center">
                  <TextBlock Text="Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª" FontSize="12" Foreground="#64748B" />
                  <TextBlock Text="(Ù…Ø§Ø¹Ù„ÙŠÙƒÙ…)" FontSize="11" Foreground="#94A3B8" />
                </StackPanel>
              </StackPanel>
              <TextBlock Text="{Binding TotalExpected, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}" FontSize="20" FontWeight="Bold" Foreground="#3B82F6" />
            </StackPanel>
          </Border>
          
          <!-- Ø§Ù„ØªØ­ØµÙŠÙ„Ø§Øª (Ø§Ù„ÙˆØ§Ø±Ø¯Ø§Øª) -->
          <Border Grid.Row="0" Grid.Column="1" Background="White" CornerRadius="12" Padding="20" Margin="0,0,10,10" BorderBrush="#E2E8F0" BorderThickness="1">
            <Border.Effect>
              <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06" />
            </Border.Effect>
            <StackPanel>
              <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Border Background="#DCFCE7" Width="40" Height="40" CornerRadius="20" Margin="0,0,10,0">
                  <TextBlock Text="ðŸ’°" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <StackPanel VerticalAlignment="Center">
                  <TextBlock Text="Ø§Ù„ØªØ­ØµÙŠÙ„Ø§Øª" FontSize="12" Foreground="#64748B" />
                  <TextBlock Text="(Ø§Ù„ÙˆØ§Ø±Ø¯Ø§Øª)" FontSize="11" Foreground="#94A3B8" />
                </StackPanel>
              </StackPanel>
              <TextBlock Text="{Binding TotalCollected, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}" FontSize="20" FontWeight="Bold" Foreground="#10B981" />
            </StackPanel>
          </Border>
          
          <!-- Ø§Ù„Ù…ØªØ£Ø®Ø±Ø§Øª -->
          <Border Grid.Row="0" Grid.Column="2" Background="White" CornerRadius="12" Padding="20" Margin="0,0,10,10" BorderBrush="#E2E8F0" BorderThickness="1">
            <Border.Effect>
              <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06" />
            </Border.Effect>
            <StackPanel>
              <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Border Background="#FEF3C7" Width="40" Height="40" CornerRadius="20" Margin="0,0,10,0">
                  <TextBlock Text="âš ï¸" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <StackPanel VerticalAlignment="Center">
                  <TextBlock Text="Ø§Ù„Ù…ØªØ£Ø®Ø±Ø§Øª" FontSize="12" Foreground="#64748B" />
                  <TextBlock Text="(ØºÙŠØ± Ù…Ø³Ø¯Ø¯Ø©)" FontSize="11" Foreground="#94A3B8" />
                </StackPanel>
              </StackPanel>
              <TextBlock Text="{Binding TotalRemaining, StringFormat='{}{0:N2} Ø±ÙŠØ§Ù„'}" FontSize="20" FontWeight="Bold" Foreground="#F59E0B" />
            </StackPanel>
          </Border>
          
          <!-- Ø§Ù„Ø³Ø§Ø¨Ù‚Ø§Øª Ø§Ù„Ù…ÙØ±Ø§ÙƒÙ…Ø© -->
          <Border Grid.Row="0" Grid.Column="3" Background="White" CornerRadius="12" Padding="20" Margin="0,0,0,10" BorderBrush="#E2E8F0" BorderThickness="1">
            <Border.Effect>
              <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06" />
            </Border.Effect>
            <StackPanel>
              <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Border Background="#FEF2F2" Width="40" Height="40" CornerRadius="20" Margin="0,0,10,0">
                  <TextBlock Text="ðŸ“‹" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <StackPanel VerticalAlignment="Center">
                  <TextBlock Text="Ø§Ù„Ø³Ø§Ø¨Ù‚Ø§Øª" FontSize="12" Foreground="#64748B" />
                  <TextBlock Text="(Ù…ÙØ±Ø§ÙƒÙ…Ø©)" FontSize="11" Foreground="#94A3B8" />
                </StackPanel>
              </StackPanel>
              <TextBlock FontSize="20" FontWeight="Bold" Foreground="#DC2626">
                <Run Text="{Binding PreviousBalance, StringFormat=N2}"/>
                <Run Text=" Ø±ÙŠØ§Ù„" FontSize="14"/>
              </TextBlock>
            </StackPanel>
          </Border>
          
          <!-- Ø§Ù„Ø®Ø±Ø¬ÙŠØ§Øª ÙˆØ§Ù„Ù…ÙÙ‚ÙˆØ¯Ø§Øª -->
          <Border Grid.Row="1" Grid.Column="0" Background="White" CornerRadius="12" Padding="20" Margin="0,0,10,0" BorderBrush="#E2E8F0" BorderThickness="1">
            <Border.Effect>
              <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06" />
            </Border.Effect>
            <StackPanel>
              <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Border Background="#FEF2F2" Width="40" Height="40" CornerRadius="20" Margin="0,0,10,0">
                  <TextBlock Text="ðŸ“¦" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <StackPanel VerticalAlignment="Center">
                  <TextBlock Text="Ø§Ù„Ø®Ø±Ø¬ÙŠØ§Øª" FontSize="12" Foreground="#64748B" />
                  <TextBlock Text="(Ù…ÙÙ‚ÙˆØ¯ + Ù…ØµØ±ÙˆÙ)" FontSize="11" Foreground="#94A3B8" />
                </StackPanel>
              </StackPanel>
              <TextBlock FontSize="20" FontWeight="Bold" Foreground="#EF4444">
                <Run Text="{Binding OtherTransactions, StringFormat=N2}"/>
                <Run Text=" Ø±ÙŠØ§Ù„" FontSize="14"/>
              </TextBlock>
            </StackPanel>
          </Border>
          
          <!-- Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->
          <Border Grid.Row="1" Grid.Column="1" Background="White" CornerRadius="12" Padding="20" Margin="0,0,0,0" BorderBrush="#10B981" BorderThickness="2">
            <Border.Effect>
              <DropShadowEffect Color="#10B981" BlurRadius="12" ShadowDepth="0" Opacity="0.2" />
            </Border.Effect>
            <StackPanel>
              <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                <Border Background="#DCFCE7" Width="40" Height="40" CornerRadius="20" Margin="0,0,10,0">
                  <TextBlock Text="ðŸ’µ" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Border>
                <StackPanel VerticalAlignment="Center">
                  <TextBlock Text="Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ" FontSize="12" Foreground="#64748B" FontWeight="Bold"/>
                  <TextBlock Text="(Ø§Ù„ØµØ§ÙÙŠ)" FontSize="11" Foreground="#94A3B8" />
                </StackPanel>
              </StackPanel>
              <TextBlock FontSize="22" FontWeight="Bold" Foreground="#10B981">
                <Run Text="{Binding FinalBalance, StringFormat=N2}"/>
                <Run Text=" Ø±ÙŠØ§Ù„" FontSize="14"/>
              </TextBlock>
            </StackPanel>
          </Border>
        </Grid>
        
        <!-- Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø« -->
        <Border
          Background="White"
          CornerRadius="10"
          Padding="12"
          Margin="0,0,0,15"
          BorderThickness="1"
          BorderBrush="#E2E8F0"
        >
          <Grid>
            <TextBox
              Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
              Style="{StaticResource ModernTextBox}"
              Height="42"
              FontSize="14"
              Padding="40,8,12,8"
            />
            <TextBlock
              Text="ðŸ”"
              FontSize="16"
              IsHitTestVisible="False"
              VerticalAlignment="Center"
              Margin="12,0,0,0"
            />
            <TextBlock
              Text="Ø¨Ø­Ø« Ø¹Ù† Ø¹Ø¶Ùˆ..."
              FontSize="14"
              Foreground="#94A3B8"
              IsHitTestVisible="False"
              VerticalAlignment="Center"
              Margin="40,0,0,0"
              Visibility="{Binding SearchText, Converter={StaticResource InverseNullToVisibility}}"
            />
          </Grid>
        </Border>
        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ -->
        <Border Background="White" CornerRadius="12" Padding="20" BorderBrush="#E2E8F0" BorderThickness="1">
          <Border.Effect>
            <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.06" />
          </Border.Effect>
          <StackPanel>
            <TextBlock
              Text="ðŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ­ØµÙŠÙ„"
              FontSize="16"
              FontWeight="SemiBold"
              Foreground="#1E293B"
              Margin="0,0,0,15"
            />
            
            <ItemsControl ItemsSource="{Binding SummaryItems}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <Border
                    Background="#F8FAFC"
                    CornerRadius="8"
                    Padding="15"
                    Margin="0,0,0,8"
                    Cursor="Hand"
                  >
                    <Border.InputBindings>
                      <MouseBinding 
                        Command="{Binding DataContext.ItemClickCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        CommandParameter="{Binding}"
                        MouseAction="LeftClick" />
                    </Border.InputBindings>
                    <Border.Style>
                      <Style TargetType="Border">
                        <Setter Property="Background" Value="#F8FAFC"/>
                        <Style.Triggers>
                          <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#EEF2FF"/>
                          </Trigger>
                        </Style.Triggers>
                      </Style>
                    </Border.Style>
                    <Grid>
                      <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                      </Grid.ColumnDefinitions>
                      
                      <!-- Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© -->
                      <Border
                        Grid.Column="0"
                        Background="White"
                        Width="36"
                        Height="36"
                        CornerRadius="18"
                        Margin="0,0,12,0"
                        VerticalAlignment="Center"
                      >
                        <TextBlock
                          Text="ðŸ‘¤"
                          FontSize="16"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                        />
                      </Border>
                      
                      <!-- Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª -->
                      <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock
                          Text="{Binding Title}"
                          FontSize="14"
                          FontWeight="SemiBold"
                          Foreground="#1E293B"
                          Margin="0,0,0,3"
                        />
                        <TextBlock
                          Text="{Binding MembersCount}"
                          FontSize="12"
                          Foreground="#64748B"
                        />
                      </StackPanel>
                      
                      <!-- Ø§Ù„Ù…Ø¨Ù„Øº -->
                      <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right" Margin="0,0,10,0">
                        <TextBlock
                          FontSize="16"
                          FontWeight="Bold"
                          Foreground="{Binding AmountColor}"
                          TextAlignment="Right"
                        >
                          <Run Text="{Binding Amount, StringFormat=N2}" />
                          <Run Text=" Ø±ÙŠØ§Ù„" FontSize="12" Foreground="#64748B" />
                        </TextBlock>
                      </StackPanel>
                      
                      <!-- Ø²Ø± Ø§Ù„ØªÙØ§ØµÙŠÙ„ -->
                      <Button
                        Grid.Column="3"
                        Command="{Binding DataContext.ItemClickCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        CommandParameter="{Binding}"
                        Style="{StaticResource SecondaryButton}"
                        Width="32"
                        Height="32"
                        Padding="0"
                        VerticalAlignment="Center"
                      >
                        <TextBlock Text="â–º" FontSize="14" FontWeight="Bold" Foreground="#64748B"/>
                      </Button>
                    </Grid>
                  </Border>
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
          </StackPanel>
        </Border>
        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ -->
        <Grid Margin="0,20,0,0">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="10"/>
            <ColumnDefinition Width="*"/>
          </Grid.ColumnDefinitions>
          
          <!-- Ø²Ø± Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠ -->
          <Button
            Grid.Column="0"
            Command="{Binding GoToCollectionCommand}"
            Style="{StaticResource PrimaryButton}"
            HorizontalAlignment="Stretch"
            Height="50"
          >
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
              <TextBlock Text="ðŸ’°" FontSize="18" Margin="0,0,10,0" VerticalAlignment="Center" />
              <TextBlock Text="Ø§Ù„ØªØ­ØµÙŠÙ„ Ø§Ù„ÙŠÙˆÙ…ÙŠ" FontSize="15" FontWeight="SemiBold" VerticalAlignment="Center" />
              <TextBlock Text="â—€" FontSize="16" Margin="10,0,0,0" FontWeight="Bold" VerticalAlignment="Center" />
            </StackPanel>
          </Button>
          
          <!-- Ø²Ø± Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù…ØªØ£Ø®Ø±Ø§Øª ÙˆØ§Ù„Ø³Ø§Ø¨Ù‚Ø§Øª -->
          <Button
            Grid.Column="2"
            Command="{Binding GoToArrearsCommand}"
            Style="{StaticResource SecondaryButton}"
            HorizontalAlignment="Stretch"
            Height="50"
          >
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
              <TextBlock Text="âš ï¸" FontSize="18" Margin="0,0,10,0" VerticalAlignment="Center" />
              <TextBlock Text="Ø§Ù„Ù…ØªØ£Ø®Ø±Ø§Øª ÙˆØ§Ù„Ø³Ø§Ø¨Ù‚Ø§Øª" FontSize="15" FontWeight="SemiBold" VerticalAlignment="Center" />
              <TextBlock Text="â—€" FontSize="16" Margin="10,0,0,0" FontWeight="Bold" VerticalAlignment="Center" />
            </StackPanel>
          </Button>
        </Grid>
      </StackPanel>
    </ScrollViewer>
  </Grid>
</UserControl>
