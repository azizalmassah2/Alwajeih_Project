<UserControl
  x:Class="Alwajeih.Views.Finance.VaultView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  FlowDirection="RightToLeft"
  FontFamily="{StaticResource Tajawal}"
  FontSize="14"
  xmlns:vm="clr-namespace:Alwajeih.ViewModels.Finance"
>
  <UserControl.DataContext>
    <vm:VaultViewModel />
  </UserControl.DataContext>
  <UserControl.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/Resources/Styles/ScrollBarStyles.xaml" />
        <ResourceDictionary Source="/Resources/Styles/DataGrids.xaml" />
        <ResourceDictionary Source="/Resources/Styles/Colors.xaml" />
        <ResourceDictionary Source="/Resources/Styles/Buttons.xaml" />
        <ResourceDictionary Source="/Resources/Styles/TextBoxes.xaml" />
        <ResourceDictionary Source="/Resources/Styles/MainStyles.xaml" />
      </ResourceDictionary.MergedDictionaries>
      <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </ResourceDictionary>
  </UserControl.Resources>
  <Grid Background="#F8FAFC">
    <ScrollViewer VerticalScrollBarVisibility="Auto" Style="{StaticResource ModernScrollViewer}">
      <StackPanel Margin="20,20">
        <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
        <StackPanel Margin="0,0,0,20">
          <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
            <TextBlock Text="ðŸ¦" FontSize="24" Margin="0,0,10,0" VerticalAlignment="Center" />
            <TextBlock
              Text="Ø§Ù„Ø®Ø²Ù†Ø©"
              FontSize="22"
              FontWeight="Bold"
              Foreground="#1E293B"
              VerticalAlignment="Center"
            />
          </StackPanel>
          <TextBlock
            Text="Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø±ØµØ¯Ø© ÙˆØ§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©"
            FontSize="13"
            Foreground="#64748B"
            Margin="34,0,0,0"
          />
        </StackPanel>
        <!-- ÙƒØ±Øª Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ -->
        <Border Margin="0,0,0,16" CornerRadius="12" Padding="20,14">
          <Border.Background>
            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
              <GradientStop Color="#2563EB" Offset="0" />
              <GradientStop Color="#3B82F6" Offset="0.5" />
              <GradientStop Color="#60A5FA" Offset="1" />
            </LinearGradientBrush>
          </Border.Background>
          <Border.Effect>
            <DropShadowEffect Color="#2563EB" BlurRadius="15" ShadowDepth="0" Opacity="0.2" />
          </Border.Effect>
          <Grid>
            <StackPanel VerticalAlignment="Center">
              <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                <TextBlock Text="ðŸ’°" FontSize="20" Margin="0,0,8,0" VerticalAlignment="Center" />
                <TextBlock
                  Text="Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ"
                  FontSize="14"
                  FontWeight="Medium"
                  Foreground="White"
                  Opacity="0.95"
                  VerticalAlignment="Center"
                />
              </StackPanel>
              <TextBlock FontSize="32" FontWeight="Bold" Foreground="White">
                <Run Text="{Binding CurrentBalance, StringFormat=N2}" />
                <Run Text=" Ø±ÙŠØ§Ù„" FontSize="20" />
              </TextBlock>
            </StackPanel>
          </Grid>
        </Border>
        <Grid Margin="0">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" MinWidth="400" />
            <ColumnDefinition Width="Auto" MinWidth="300" MaxWidth="400" />
          </Grid.ColumnDefinitions>
          <!-- Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª -->
          <Border
            Grid.Column="0"
            Background="White"
            CornerRadius="12"
            Padding="20"
            Margin="0,0,15,0"
          >
            <Border.Effect>
              <DropShadowEffect Color="Black" BlurRadius="8" ShadowDepth="0" Opacity="0.08" />
            </Border.Effect>
            <StackPanel>
              <TextBlock
                Text="ðŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª"
                FontSize="16"
                FontWeight="SemiBold"
                Foreground="#1E293B"
                Margin="0,0,0,12"
              />
              <Grid Margin="0,0,0,15">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="*" />
                  <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <DatePicker Grid.Column="0" SelectedDate="{Binding StartDate}" Margin="0,0,10,0" />
                <DatePicker Grid.Column="1" SelectedDate="{Binding EndDate}" Margin="0,0,10,0" />
                <Button
                  Grid.Column="2"
                  Content="ðŸ” ØªØµÙÙŠØ©"
                  Command="{Binding FilterCommand}"
                  Width="Auto" MinWidth="80"
                />
              </Grid>
              <Border CornerRadius="8" BorderBrush="#E2E8F0" BorderThickness="1" Background="White" Margin="0,12,0,0">
                <DataGrid
                  ItemsSource="{Binding Transactions}"
                  Height="400"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  Style="{StaticResource ModernDataGrid}"
                  BorderThickness="0">
                  <DataGrid.Columns>
                    <DataGridTextColumn
                      Header="Ø§Ù„ØªØ§Ø±ÙŠØ®"
                      Binding="{Binding TransactionDate, StringFormat=yyyy-MM-dd}"
                      Width="Auto"
                      MinWidth="100"
                    />
                    <DataGridTextColumn
                      Header="Ø§Ù„Ù†ÙˆØ¹"
                      Binding="{Binding TransactionTypeArabic}"
                      Width="Auto"
                      MinWidth="80"
                    />
                    <DataGridTextColumn
                      Header="Ø§Ù„Ù…Ø¨Ù„Øº"
                      Binding="{Binding Amount, StringFormat=N2}"
                      Width="Auto"
                      MinWidth="100"
                    />
                    <DataGridTextColumn
                      Header="Ø§Ù„Ø¹Ø¶Ùˆ"
                      Binding="{Binding MemberName}"
                      Width="Auto"
                      MinWidth="120"
                    />
                    <DataGridTextColumn Header="Ø§Ù„ÙˆØµÙ" Binding="{Binding Description}" Width="*" MinWidth="150" />
                    <DataGridTextColumn Header="Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" Binding="{Binding UserName}" Width="Auto" MinWidth="100" />
                  </DataGrid.Columns>
                </DataGrid>
              </Border>
            </StackPanel>
          </Border>
          <!-- Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù…Ù„Ø© -->
          <Border Grid.Column="1" Style="{StaticResource ModernCard}">
            <StackPanel>
              <StackPanel Orientation="Horizontal">
                <TextBlock Text="ðŸ’¸ Ø³Ø­Ø¨ Ù…Ù† Ø§Ù„Ø®Ø²Ù†Ø©" 
                           Style="{StaticResource SectionTitle}"
                           Visibility="{Binding IsWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}" />
                <TextBlock Text="ðŸ’° Ø¥ÙŠØ¯Ø§Ø¹ ÙÙŠ Ø§Ù„Ø®Ø²Ù†Ø©" 
                           Style="{StaticResource SectionTitle}"
                           Visibility="{Binding IsDeposit, Converter={StaticResource BoolToVisibilityConverter}}" />
              </StackPanel>
              
              <!-- Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© -->
              <TextBlock
                Text="Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© *"
                Style="{StaticResource FieldLabel}"
                Margin="0,15,0,5"
              />
              <ComboBox
                SelectedIndex="{Binding TransactionTypeIndex}"
                Style="{StaticResource ModernComboBox}"
              >
                <ComboBoxItem Content="ðŸ’° Ø¥ÙŠØ¯Ø§Ø¹" />
                <ComboBoxItem Content="ðŸ’¸ Ø³Ø­Ø¨" IsSelected="True" />
              </ComboBox>
              
              <!-- Ù†ÙˆØ¹ Ø§Ù„Ø³Ø­Ø¨ -->
              <TextBlock
                Style="{StaticResource FieldLabel}"
                Margin="0,15,0,5"
                Visibility="{Binding IsWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}"
              >
                <Run Text="Ù†ÙˆØ¹ Ø§Ù„Ø³Ø­Ø¨ *" />
              </TextBlock>
              <ComboBox
                SelectedItem="{Binding SelectedCategory}"
                Style="{StaticResource ModernComboBox}"
                Visibility="{Binding IsWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}"
              >
                <ComboBox.Items>
                  <ComboBoxItem Content="ðŸ‘¤ Ø³Ø­Ø¨ Ù„Ø¹Ø¶Ùˆ/Ø¹Ù…ÙŠÙ„" Tag="MemberWithdrawal" />
                  <ComboBoxItem Content="ðŸ’° Ø³Ø­Ø¨ Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø®Ù„Ù Ø§Ù„Ø¬Ù…Ø¹ÙŠØ©" Tag="BehindAssociationWithdrawal" />
                  <ComboBoxItem Content="ðŸ¢ Ø®Ø±Ø¬ÙŠØ§Øª" Tag="ManagerWithdrawals" IsSelected="True" />
                  <ComboBoxItem Content="âŒ Ù…ÙÙ‚ÙˆØ¯" Tag="Missing" />
                  <ComboBoxItem Content="ðŸ”§ Ù…ØµØ±ÙˆÙ " Tag="OperatingExpense" />
                  <ComboBoxItem Content="ðŸ“‹ Ø£Ø®Ø±Ù‰" Tag="Other" />
                </ComboBox.Items>
              </ComboBox>
              
              <!-- Ù…ØµØ¯Ø± Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ -->
              <TextBlock
                Style="{StaticResource FieldLabel}"
                Margin="0,15,0,5"
                Visibility="{Binding IsDeposit, Converter={StaticResource BoolToVisibilityConverter}}"
              >
                <Run Text="Ù…ØµØ¯Ø± Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ *" />
              </TextBlock>
              <ComboBox
                SelectedItem="{Binding SelectedDepositCategory}"
                Style="{StaticResource ModernComboBox}"
                Visibility="{Binding IsDeposit, Converter={StaticResource BoolToVisibilityConverter}}"
              >
                <ComboBox.Items>
                  <ComboBoxItem Content="ðŸ’° Ø¥ÙŠØ¯Ø§Ø¹ Ù…Ù† Ø¹Ø¶Ùˆ" Tag="MemberDeposit" IsSelected="True" />
                  <ComboBoxItem Content="ðŸ’¼ Ø¥ÙŠØ¯Ø§Ø¹ ØªØ´ØºÙŠÙ„ÙŠ" Tag="OperatingDeposit" />
                  <ComboBoxItem Content="ðŸ“‹ Ø£Ø®Ø±Ù‰" Tag="Other" />
                </ComboBox.Items>
              </ComboBox>
              
              <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¹Ø¶Ùˆ (ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø³Ø­Ø¨ Ù„Ø¹Ø¶Ùˆ) -->
              <TextBlock
                Text="Ø§Ù„Ø¹Ø¶Ùˆ *"
                Style="{StaticResource FieldLabel}"
                Margin="0,15,0,5"
                Visibility="{Binding IsMemberWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}"
              />
              <ComboBox
                ItemsSource="{Binding FilteredMembers}"
                SelectedItem="{Binding SelectedMember}"
                DisplayMemberPath="Name"
                Style="{StaticResource ModernComboBox}"
                Visibility="{Binding IsMemberWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}"
                IsEditable="True"
                IsTextSearchEnabled="True"
                StaysOpenOnEdit="True"
                Text="{Binding MemberSearchText, UpdateSourceTrigger=PropertyChanged}"
              />
              
              <!-- Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¶Ùˆ Ø®Ù„Ù Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© (ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø§Ø®ØªÙŠØ§Ø± Ø³Ø­Ø¨ Ù„Ø£Ø¹Ø¶Ø§Ø¡ Ø®Ù„Ù Ø§Ù„Ø¬Ù…Ø¹ÙŠØ©) -->
              <TextBlock
                Text="Ø¹Ø¶Ùˆ Ø®Ù„Ù Ø§Ù„Ø¬Ù…Ø¹ÙŠØ© *"
                Style="{StaticResource FieldLabel}"
                Margin="0,15,0,5"
                Visibility="{Binding IsBehindAssociationWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}"
              />
              <ComboBox
                ItemsSource="{Binding BehindAssociationMembers}"
                SelectedItem="{Binding SelectedBehindAssociationMember}"
                DisplayMemberPath="Name"
                Style="{StaticResource ModernComboBox}"
                Visibility="{Binding IsBehindAssociationWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}"
                IsEditable="True"
                IsTextSearchEnabled="True"
                StaysOpenOnEdit="True"
              />
              <TextBlock
                Text="Ø§Ù„Ù…Ø¨Ù„Øº (Ø±ÙŠØ§Ù„) *"
                Style="{StaticResource FieldLabel}"
                Margin="0,15,0,5"
              />
              <TextBox
                Text="{Binding Amount}"
                Style="{StaticResource ModernTextBox}"
                FontSize="16"
                Height="50"
              />
              <TextBlock
                Text="Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙØ¹ *"
                Style="{StaticResource FieldLabel}"
                Margin="0,15,0,5"
              />
              <ComboBox
                SelectedIndex="{Binding PaymentSourceIndex}"
                Style="{StaticResource ModernComboBox}"
                Margin="0,0,0,15"
              >
                <ComboBoxItem Content="Ù†Ù‚Ø¯" />
                <ComboBoxItem Content="ÙƒØ±ÙŠÙ…ÙŠ" />
              </ComboBox>
              <TextBlock Style="{StaticResource FieldLabel}" Margin="0,15,0,5" Text="Ù…Ù„Ø§Ø­Ø¸Ø§Øª" />
              <TextBox
                Text="{Binding Description}"
                Style="{StaticResource ModernTextBox}"
                Height="80"
                TextWrapping="Wrap"
                AcceptsReturn="True"
              />
              <Button
                Command="{Binding AddTransactionCommand}"
                Height="50"
                Margin="0,25,0,0"
              >
                <Button.Style>
                  <Style TargetType="Button" BasedOn="{StaticResource DangerButton}">
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding IsDeposit}" Value="True">
                        <Setter Property="Background" Value="#10B981" />
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </Button.Style>
                <StackPanel Orientation="Horizontal">
                  <TextBlock Text="ðŸ’¸" FontSize="18" Margin="0,0,10,0"
                             Visibility="{Binding IsWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}" />
                  <TextBlock Text="ðŸ’°" FontSize="18" Margin="0,0,10,0"
                             Visibility="{Binding IsDeposit, Converter={StaticResource BoolToVisibilityConverter}}" />
                  <TextBlock Text="Ø³Ø­Ø¨" FontSize="16"
                             Visibility="{Binding IsWithdrawal, Converter={StaticResource BoolToVisibilityConverter}}" />
                  <TextBlock Text="Ø¥ÙŠØ¯Ø§Ø¹" FontSize="16"
                             Visibility="{Binding IsDeposit, Converter={StaticResource BoolToVisibilityConverter}}" />
                </StackPanel>
              </Button>
              
              <Border CornerRadius="8" Padding="12" Margin="0,15,0,0">
                <Border.Style>
                  <Style TargetType="Border">
                    <Setter Property="Background" Value="#FEF2F2" />
                    <Style.Triggers>
                      <DataTrigger Binding="{Binding IsDeposit}" Value="True">
                        <Setter Property="Background" Value="#ECFDF5" />
                      </DataTrigger>
                    </Style.Triggers>
                  </Style>
                </Border.Style>
                <StackPanel>
                  <TextBlock FontWeight="SemiBold" FontSize="13">
                    <TextBlock.Style>
                      <Style TargetType="TextBlock">
                        <Setter Property="Foreground" Value="#DC2626" />
                        <Setter Property="Text" Value="â„¹ï¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø©" />
                        <Style.Triggers>
                          <DataTrigger Binding="{Binding IsDeposit}" Value="True">
                            <Setter Property="Foreground" Value="#059669" />
                          </DataTrigger>
                        </Style.Triggers>
                      </Style>
                    </TextBlock.Style>
                  </TextBlock>
                  <TextBlock FontSize="12" TextWrapping="Wrap" Margin="0,5,0,0">
                    <TextBlock.Style>
                      <Style TargetType="TextBlock">
                        <Setter Property="Foreground" Value="#991B1B" />
                        <Setter Property="Text" Value="Ø§Ù„Ø³Ø­ÙˆØ¨Ø§Øª ØªØ¤Ø«Ø± Ø¹Ù„Ù‰ Ø±ØµÙŠØ¯ Ø§Ù„Ø®Ø²Ù†Ø© Ù…Ø¨Ø§Ø´Ø±Ø©" />
                        <Style.Triggers>
                          <DataTrigger Binding="{Binding IsDeposit}" Value="True">
                            <Setter Property="Foreground" Value="#047857" />
                            <Setter Property="Text" Value="ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥ÙŠØ¯Ø§Ø¹ ÙŠØ¯ÙˆÙŠØ§Ù‹ Ø£Ùˆ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø¬Ø±Ø¯ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ" />
                          </DataTrigger>
                        </Style.Triggers>
                      </Style>
                    </TextBlock.Style>
                  </TextBlock>
                </StackPanel>
              </Border>
            </StackPanel>
          </Border>
        </Grid>
      </StackPanel>
    </ScrollViewer>
  </Grid>
</UserControl>
